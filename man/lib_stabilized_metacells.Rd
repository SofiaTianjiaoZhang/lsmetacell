% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lib_stabilized_metacells.R
\name{lib_stabilized_metacells}
\alias{lib_stabilized_metacells}
\title{Create Library Size-Stabilized Meta-Cells}
\usage{
lib_stabilized_metacells(
  count_matrix,
  similarity_matrix = NULL,
  meta_cells_num = 1000,
  seed = 123,
  return_cell_index = FALSE
)
}
\arguments{
\item{count_matrix}{The gene expression count matrix (genes  x cells)}

\item{similarity_matrix}{Optional pre-computed cell-cell similarity matrix (default: NULL)}

\item{meta_cells_num}{Target number of meta-cells to create (default: 1000)}

\item{seed}{Random seed for reproducibility (default: NULL)}

\item{return_cell_index}{Logical. If \code{TRUE}, return a list containing both
the meta-cell matrix (\code{meta_cells}) and the mapping from original cells to
meta-cells (\code{meta_index}). Default is \code{FALSE} for backward compatibility.}
}
\value{
By default (\code{return_cell_index = FALSE}), a matrix of meta-cell expression
(genes × meta-cells).

If \code{return_cell_index = TRUE}, a named list with components:
\describe{
\item{meta_cells}{genes × meta-cells expression matrix}
\item{meta_index}{integer vector of length \code{ncol(count_matrix)} mapping
each original cell to its meta-cell ID}
}
}
\description{
Generate meta-cells with stabilized library sizes by aggregating similar cells while
accounting for sequencing depth variation. This helps reduce technical noise in single-cell RNA-seq data.
}
\examples{
# Example usage:
data(sample_counts) # A genes x cells count matrix
metacells <- lib_stabilized_metacells(as.matrix(sample_counts), meta_cells_num = 5)
}
