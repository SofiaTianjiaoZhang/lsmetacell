% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lib_stabilized_metacells_by_group.R
\name{lib_stabilized_metacells_by_group}
\alias{lib_stabilized_metacells_by_group}
\title{Create Library Size-Stabilized Meta-Cells Within Specified Groups}
\usage{
lib_stabilized_metacells_by_group(
  count_matrix,
  meta_cells_num = 1000,
  group_id,
  similarity_matrix = NULL,
  seed = 123,
  return_cell_index = FALSE
)
}
\arguments{
\item{count_matrix}{A gene expression count matrix (genes x cells).}

\item{meta_cells_num}{Target total number of meta-cells (default: 1000).}

\item{group_id}{Vector specifying group membership for each cell (length must match ncol(count_matrix))}

\item{similarity_matrix}{Optional pre-computed cell-cell similarity matrix (default: NULL).}

\item{seed}{Random seed for reproducibility (default: 123)}

\item{return_cell_index}{Logical. If TRUE, return a list with
\code{meta_cells} and \code{meta_index}; see return value below}
}
\value{
By default (\code{return_cell_index = FALSE}), a combined meta-cell expression
matrix (genes × meta-cells).

If \code{return_cell_index = TRUE}, a named list with components:
\describe{
\item{meta_cells}{genes × meta-cells expression matrix}
\item{meta_index}{integer vector of length \code{ncol(count_matrix)} mapping
each original cell to its meta-cell ID across all groups}
}
}
\description{
Generates meta-cells with stabilized library sizes separately for each group of cells,
then combines the results. This preserves biological heterogeneity while reducing
technical noise within each group.
}
\examples{
# Example usage:
data(sample_counts) # genes x cells matrix
groups <- rep(c("A","B"), each=100) # 200 cells
metacells <- lib_stabilized_metacells_by_group(
  count_matrix = as.matrix(sample_counts),
  meta_cells_num = 20,
  group_id = groups
)
}
